{% extends 'main_app/base.html' %}
{% load static %}

{% block page_title %}{{ page_title }}{% endblock %}

{% block content %}
<div class="card mb-4">
  <div class="card-header">
    <form method="get" class="row g-2">
      <div class="col">
        <select name="warehouse" class="form-select">
          <option value="">All Warehouses</option>
          {% for w in warehouses %}
            <option value="{{ w.id }}" {% if selected_warehouse == w.id|stringformat:"s" %}selected{% endif %}>
              {{ w.name }}
            </option>
          {% endfor %}
        </select>
      </div>
      <div class="col">
        <select name="grade" class="form-select">
          <option value="">All Grades</option>
          {% for g in grades %}
            <option value="{{ g }}" {% if selected_grade == g %}selected{% endif %}>
              {{ g }}
            </option>
          {% endfor %}
        </select>
      </div>
      <div class="col">
        <input type="text" name="sku" value="{{ selected_sku }}" placeholder="Search SKU" class="form-control">
      </div>
      <div class="col">
        <button class="btn btn-primary">Filter</button>
      </div>
    </form>
  </div>

  <div class="card-body">
    <h5 class="mb-3">SKU-wise Inventory Planning</h5>
    <div class="table-responsive">
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-primary">
          <tr>
            <th>Warehouse</th>
            <th>Grade</th>
            <th>SKU Code</th>
            <th>Product Description</th>
            <th>Orders Received</th>
            <th>Stock Available</th>
            <th>Shortage</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          {% for item in summary %}
          <tr class="{% if item.alert %}table-warning{% endif %}">
            <td>{{ item.warehouse }}</td>
            <td>{{ item.grade }}</td>
            <td>{{ item.sku }}</td>
            <td>{{ item.product }}</td>
            <td>{{ item.orders_received }}</td>
            <td>{{ item.stock_available }}</td>
            <td>{{ item.shortage }}</td>
            <td>
              {% if item.shortage > 0 %}
                <span class="badge bg-warning text-dark">Pending</span>
              {% else %}
                <span class="badge bg-success">Fulfilled</span>
              {% endif %}
            </td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="8">No inventory summary available.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
